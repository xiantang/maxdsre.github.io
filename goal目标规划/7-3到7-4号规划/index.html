<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>xiantang </title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.63.0-DEV" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.3f5912c237ddd38c8e76debe081c7ca7.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="" />
<meta property="og:description" content="深入理解JVM 7/3-7/13 什么是栈帧？ sync 锁降级？ JIT 编译器的发展？ 逃逸分析？ string intern 方法？     tiny Spring 源码阅读 7/14-7/24 为什么要用concurrentHashMap 做 容器     Java 并发编程的艺术 7/24-8/01     公司源码 消息中间件怎么用 用在哪里 分布式锁 怎么用 场景  分布式锁？ setnx()函数 ？ Redis 连接池   负载均衡算法 读写分离 主备 数据库 限权管理怎么做的    10000w行log 查指定时间
sed -n &lsquo;/2015-05-04 09:25:55/,/2015-05-04 09:28:55/&lsquo;p /home/wwwlogs/access.log
星期一/星期二/星期四
10-&gt;12 吃饭 这段时间 看 JVM Spring" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiantang.github.io/goal%E7%9B%AE%E6%A0%87%E8%A7%84%E5%88%92/7-3%E5%88%B07-4%E5%8F%B7%E8%A7%84%E5%88%92/" />

<meta itemprop="name" content="">
<meta itemprop="description" content="深入理解JVM 7/3-7/13 什么是栈帧？ sync 锁降级？ JIT 编译器的发展？ 逃逸分析？ string intern 方法？     tiny Spring 源码阅读 7/14-7/24 为什么要用concurrentHashMap 做 容器     Java 并发编程的艺术 7/24-8/01     公司源码 消息中间件怎么用 用在哪里 分布式锁 怎么用 场景  分布式锁？ setnx()函数 ？ Redis 连接池   负载均衡算法 读写分离 主备 数据库 限权管理怎么做的    10000w行log 查指定时间
sed -n &lsquo;/2015-05-04 09:25:55/,/2015-05-04 09:28:55/&lsquo;p /home/wwwlogs/access.log
星期一/星期二/星期四
10-&gt;12 吃饭 这段时间 看 JVM Spring">

<meta itemprop="wordCount" content="577">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="深入理解JVM 7/3-7/13 什么是栈帧？ sync 锁降级？ JIT 编译器的发展？ 逃逸分析？ string intern 方法？     tiny Spring 源码阅读 7/14-7/24 为什么要用concurrentHashMap 做 容器     Java 并发编程的艺术 7/24-8/01     公司源码 消息中间件怎么用 用在哪里 分布式锁 怎么用 场景  分布式锁？ setnx()函数 ？ Redis 连接池   负载均衡算法 读写分离 主备 数据库 限权管理怎么做的    10000w行log 查指定时间
sed -n &lsquo;/2015-05-04 09:25:55/,/2015-05-04 09:28:55/&lsquo;p /home/wwwlogs/access.log
星期一/星期二/星期四
10-&gt;12 吃饭 这段时间 看 JVM Spring"/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://xiantang.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      xiantang
    </a>
    <div class="flex-l items-center">
      

      
      













    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        GOAL(目标规划)S
      </p>
      <h1 class="f1 athelas mb1"></h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="0001-01-01T00:00:00Z">January 1, 0001</time>
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><ul>
<li>
<ul>
<li><input checked="" disabled="" type="checkbox">深入理解JVM 7/3-7/13</li>
<li><input checked="" disabled="" type="checkbox">什么是栈帧？</li>
<li><input disabled="" type="checkbox">sync 锁降级？</li>
<li><input disabled="" type="checkbox">JIT 编译器的发展？ 逃逸分析？</li>
<li><input checked="" disabled="" type="checkbox">string intern 方法？</li>
</ul>
</li>
<li>
<ul>
<li><input checked="" disabled="" type="checkbox">tiny Spring 源码阅读 7/14-7/24</li>
<li><input checked="" disabled="" type="checkbox">为什么要用concurrentHashMap 做 容器</li>
</ul>
</li>
<li>
<ul>
<li><input checked="" disabled="" type="checkbox">Java 并发编程的艺术 7/24-8/01</li>
</ul>
</li>
<li>
<ul>
<li><input disabled="" type="checkbox">公司源码</li>
<li><input disabled="" type="checkbox">消息中间件怎么用 用在哪里</li>
<li><input checked="" disabled="" type="checkbox">分布式锁 怎么用 场景
<ul>
<li><input checked="" disabled="" type="checkbox">分布式锁？ setnx()函数 ？</li>
<li><input checked="" disabled="" type="checkbox">Redis 连接池</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox">负载均衡算法</li>
<li><input checked="" disabled="" type="checkbox">读写分离 主备 数据库</li>
<li><input checked="" disabled="" type="checkbox">限权管理怎么做的</li>
</ul>
</li>
</ul>
<p>10000w行log 查指定时间</p>
<p>sed -n &lsquo;/2015-05-04 09:25:55/,/2015-05-04 09:28:55/&lsquo;p  /home/wwwlogs/access.log</p>
<p>星期一/星期二/星期四</p>
<p>10-&gt;12 吃饭 这段时间 看 JVM Spring</p>
<p>12-&gt;1:30 健身房 锻炼</p>
<p>1:45-&gt;6:00 写需求  看项目架构</p>
<p>6:00-&gt;6:30 吃饭</p>
<p>6:45-&gt;8:00 继续看JVM 并发 Spring</p>
<p>JVM 7/3 7/13 每天看29页 如果超出就快速进入下一专题</p>
<p>tiny Spring  7/14 7/24  边看边实现 一天一步</p>
<p>Java 编程艺术 7/24 8/1</p>
<p>星期三/星期五</p>
<p>10-&gt;12 写需求</p>
<p>12-&gt;1:30 健身房 锻炼</p>
<p>1:45-&gt;6:00 写需求 看项目架构</p>
<p>6:00-&gt;6:30 吃饭</p>
<p>6:45-&gt;8:00 继续看JVM 并发 Spring</p>
<p>周末</p>
<p>9:00 公司 JVM Spring 并发</p>
<p>中午吃饭</p>
<p>1:30-&gt;6:00 写算法</p>
<p>6:00  下班</p>
<p>晚上看剧放松 打游戏</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> CommonRet <span style="color:#a6e22e">lockCluster</span><span style="color:#f92672">(</span>Integer clusterId<span style="color:#f92672">,</span>String value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		CommonRet ret <span style="color:#f92672">=</span><span style="color:#66d9ef">new</span> CommonRet<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		String key <span style="color:#f92672">=</span> QLB_L4_REDIS_LOCK_PRE <span style="color:#f92672">+</span> clusterId<span style="color:#f92672">;</span>

		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>

			Integer redisTimeOut <span style="color:#f92672">=</span> qlbDeployService<span style="color:#f92672">.</span><span style="color:#a6e22e">getQlbRedisLockTimeOut</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			ret<span style="color:#f92672">.</span><span style="color:#a6e22e">setMsg</span><span style="color:#f92672">(</span>value<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#75715e">//分布式锁
</span><span style="color:#75715e"></span>			<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>LockUtil<span style="color:#f92672">.</span><span style="color:#a6e22e">tryLock</span><span style="color:#f92672">(</span>key<span style="color:#f92672">,</span>value<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
				LockUtil<span style="color:#f92672">.</span><span style="color:#a6e22e">expireKey</span><span style="color:#f92672">(</span>key<span style="color:#f92672">,</span> redisTimeOut<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
				logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;lockRedisJsonValueByKey &#34;</span> <span style="color:#f92672">+</span> key<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
				ret<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>clusterEditingMsg<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;cluster lock key:&#34;</span> <span style="color:#f92672">+</span> key <span style="color:#f92672">+</span><span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">+</span> ex<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			ret<span style="color:#f92672">.</span><span style="color:#a6e22e">setCode</span><span style="color:#f92672">(</span>CommonRet<span style="color:#f92672">.</span><span style="color:#a6e22e">ERROR</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
		<span style="color:#66d9ef">return</span> ret<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LockUtil</span> <span style="color:#f92672">{</span>
	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Logger logger <span style="color:#f92672">=</span> LoggerFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getLogger</span><span style="color:#f92672">(</span>LockUtil<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 *  分布式锁
</span><span style="color:#75715e">	 * @param key
</span><span style="color:#75715e">	 * @param value
</span><span style="color:#75715e">	 * @return
</span><span style="color:#75715e">	 */</span>
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">tryLock</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">,</span> String value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		Jedis client <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
			client <span style="color:#f92672">=</span> RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">getClient</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>client<span style="color:#f92672">.</span><span style="color:#a6e22e">setnx</span><span style="color:#f92672">(</span>key<span style="color:#f92672">,</span> value<span style="color:#f92672">)</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> 1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
				<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;key:&#34;</span> <span style="color:#f92672">+</span> key <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; value:&#34;</span> <span style="color:#f92672">+</span> value <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> ex<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>ex<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
			RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">quitClient</span><span style="color:#f92672">(</span>client<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 *  分布式锁，添加重试次数
</span><span style="color:#75715e">	 * @param key
</span><span style="color:#75715e">	 * @param value
</span><span style="color:#75715e">	 * @return
</span><span style="color:#75715e">	 */</span>
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">tryLock</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">,</span> String value<span style="color:#f92672">,</span>Integer retryTimes<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Integer i<span style="color:#f92672">=</span>0<span style="color:#f92672">;</span>i<span style="color:#f92672">&lt;</span>retryTimes<span style="color:#f92672">;</span>i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			<span style="color:#66d9ef">boolean</span> flg <span style="color:#f92672">=</span> tryLock<span style="color:#f92672">(</span>key<span style="color:#f92672">,</span>value<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>flg<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
				<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span>
			<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
				Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">sleep</span><span style="color:#f92672">(</span>1000<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>InterruptedException ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

			<span style="color:#f92672">}</span>
		<span style="color:#f92672">}</span>
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 根据key和key的value来解锁，防止解锁的值不是自己加锁的情况
</span><span style="color:#75715e">	 * @param key
</span><span style="color:#75715e">	 * @param value
</span><span style="color:#75715e">	 */</span>
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">unLockWithValue</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">,</span>String value<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		Jedis client <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
		<span style="color:#66d9ef">boolean</span> flg <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
			client <span style="color:#f92672">=</span> RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">getClient</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			String oldValue <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>key<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>value<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>oldValue<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
				RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">removeKey</span><span style="color:#f92672">(</span>client<span style="color:#f92672">,</span>key<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
				flg <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
				logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;invalid delete key:&#34;</span> <span style="color:#f92672">+</span> key<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; value:&#34;</span> <span style="color:#f92672">+</span> value <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;,old value &#34;</span><span style="color:#f92672">+</span>oldValue<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#f92672">}</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;key:&#34;</span><span style="color:#f92672">+</span>key<span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; value:&#34;</span><span style="color:#f92672">+</span>value <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> ex<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>ex<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
			RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">quitClient</span><span style="color:#f92672">(</span>client<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
		<span style="color:#66d9ef">return</span> flg<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 直接解锁
</span><span style="color:#75715e">	 * @param key
</span><span style="color:#75715e">	 */</span>
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">unLock</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		Jedis client <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
			client <span style="color:#f92672">=</span> RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">getClient</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">removeKey</span><span style="color:#f92672">(</span>client<span style="color:#f92672">,</span>key<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>ex<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>ex<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
			RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">quitClient</span><span style="color:#f92672">(</span>client<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
	<span style="color:#f92672">}</span>



	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 设置key存活时间
</span><span style="color:#75715e">	 */</span>
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">expireKey</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">,</span><span style="color:#66d9ef">int</span> seconds<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		Jedis client <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
			client <span style="color:#f92672">=</span> RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">getClient</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#66d9ef">return</span> RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">expireKey</span><span style="color:#f92672">(</span>client<span style="color:#f92672">,</span> key<span style="color:#f92672">,</span> seconds<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>ex<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> ex<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
			RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">quitClient</span><span style="color:#f92672">(</span>client<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * 判断锁是否存在
</span><span style="color:#75715e">	 */</span>
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span>String key<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		Jedis client <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
		<span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
			client <span style="color:#f92672">=</span> RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">getClient</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
			<span style="color:#66d9ef">return</span> client<span style="color:#f92672">.</span><span style="color:#a6e22e">exists</span><span style="color:#f92672">(</span>key<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
			logger<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>ex<span style="color:#f92672">.</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> ex<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
			RedisWritePool<span style="color:#f92672">.</span><span style="color:#a6e22e">quitClient</span><span style="color:#f92672">(</span>client<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
		<span style="color:#f92672">}</span>
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>

</code></pre></div><ol>
<li>
<p>A a = new A()</p>
</li>
<li>
<p>小对象 Eden</p>
<p>大对象 老年代</p>
</li>
<li>
<p>GC 幸存者区 GC 分代年龄 默认15 　动态对象年龄判定</p>
</li>
<li>
<p>老年代回收器回收</p>
</li>
<li>
<p>finalize() 判断有没有被调用过</p>
</li>
</ol>
<p>在爱奇艺做了什么？ 排障
负载均衡算法 怎么 把流量打均匀 session
<del>一个对象的生命周期</del>
<del>JVM 是怎么创建一个线程的</del>
<del>为什么要有三次握手和四次挥手</del>
<del>布隆过滤器怎么调参</del>
<del>布隆过滤器的哈希函数是自己实现的吗? 不是</del>
为什么wait time 是2MSL 如果是10MSL 20MSL 会怎么样
NIO 的核心理念是什么？Selector.select()
<del>NIO 多路复用select() poll() epoll()  演进流程 同步到异步</del></p>
<p><del>服务器最多建立多少TCP 链接 80  通过增加内存、修改最大文件描述符个数等参数，单机最大并发TCP连接数<strong>超过10万</strong> 是没问题的</del></p>
<p><del>client 能建立多少个链接  1024-65535</del></p>
<p><del>JVM 内存模型（你给我说清楚 是JVM 还是JMM)</del>
<del>JMM 工作内存 和 主内存主要是什么</del>
<del>JVM 运行时候数据模型是怎么样的?</del>
<del>happens before 原则运用</del>
<del>实现热加载 热加载 我说重新new 类加载器 他好像不满意？？  搞个字节码</del>
<del>双亲委派怎么实现的 解决了什么问题</del>
解决碎片 不怎么了解垃圾回收器？ 解决碎片主要用什么收集器？</p>
<p>内部碎片外部碎片</p>
<p>反转链表 撕了
买股票的最佳时间（买卖一次）</p>
<p>8/21 - 8/26 规划</p>
<ul>
<li>第4章 虚拟机性能监控与故障处理工具</li>
<li>第5章 调优案例分析与实战</li>
<li>第6章 类文件结构</li>
<li>第7章 7.2 7.3 7.3.1  7.32 7.3.3</li>
<li>第8章 虚拟机字节码执行引擎</li>
<li>第10章 早期（编译期）优化</li>
<li>第12章  Java内存模型与线程</li>
</ul>
<ul class="pa0">
  
</ul>
<div class="mt6">
      
      
      </div>
    </section>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://xiantang.github.io/" >
    &copy;  xiantang 2020 
  </a>
    <div>












</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
