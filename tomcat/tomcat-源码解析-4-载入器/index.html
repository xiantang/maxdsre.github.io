<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>xiantang </title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.63.0-DEV" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.3f5912c237ddd38c8e76debe081c7ca7.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="" />
<meta property="og:description" content="类加载器 类加载的好处是可以将Java 类动态的加载到 JVM 中并且运行，就可以在程序运行中再加载类。
在Java 体系中，我们可以将系统分为3中类加载器:
 启动类加载器: 加载Java 的核心库，把核心的Java 类加载进JVM。这个加载器使用的原生 C&#43;&#43; 实现，是所有其他类加载器的父类加载器，负责加载&lt;Java_HOME&gt;/jre/lib 目录下的JVM 指定类库。 拓展类加载器:加载Java 的拓展类库，加载&lt;Java_HOME&gt;/jre/lib/etx 目录中的类。 应用程序类加载器: 系统类加载器负责加载用户类库中的指定类库。  并且类加载器还有各种机制:
  在Java 中，我们用完全匹配类命名来标识一个类，就是用包名.类名，但是在JVM 中一个类由完全匹配类名和一个类加载器实例的ID来标识一个类，当我们判断两个类是否相等的时候，只要他们由两个不同的类加载器加载的前提下才有意义，否则就算相同的字节码，如果由不同的类加载器实例加载，这两个类也是不相同的。这种特征为我们提供了隔离机制。
  类加载器有一个全盘机制当类加载加载一个类的时候，他的依赖的应用的其他所有类都由这个类加载器加载，除非显示的调用这个其他类加载加载。
  对于类加载器加载对象的时候他只会去加载那些必须的对象，只会加载父类对象，理由也很简单为了实现多态，需要将父类的入口方法连接起来，实现方法表。对于这些父类，调用加载子类的类加载器去加载，并且通过向上委托的方式加载。
  只有真正执行到对应的代码，遇到 new 关键词的时候，才会去加载对应的外部引用的类，达到了按需处理的效果。
  如果当前类加载器，已经加载了对应的类，第二次遇到new时候，Java 会隐式的从方法区中获取对应的类。
    载入器 Tomcat 如果使用的系统的类加载器去加载某个servlet 中所有需要使用的类，那么servlet 就可以访问所有的类，比如 Java 虚拟机中环境变量中CLASSPATH 指明路径下的所有类和库。servlet 应该只允许再入WEB-INF/class 中的目录，以及它的子目录下的类。
并且Tomcat 需要实现自定义类加载器的原因是因为为了提供自动重载的功能。类载入器会开启一个线程不断检查文件的时间戳。如果要实现重载入的功能就必须实现Reload 接口。在Tomcat 7 中已经将Reloader 接口合并入Loader 接口中。
​
WebAppLoader 对于Tomcat 的重载，如果你在 conf/server.xml 的 ｀｀标签设置了 reloadable 为ture 的话,Tomcat 会为你开启一个后台线程，去监控该 Context 中所有classes 文件的修改，并且重新加载。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xiantang.github.io/tomcat/tomcat-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90-4-%E8%BD%BD%E5%85%A5%E5%99%A8/" />

<meta itemprop="name" content="">
<meta itemprop="description" content="类加载器 类加载的好处是可以将Java 类动态的加载到 JVM 中并且运行，就可以在程序运行中再加载类。
在Java 体系中，我们可以将系统分为3中类加载器:
 启动类加载器: 加载Java 的核心库，把核心的Java 类加载进JVM。这个加载器使用的原生 C&#43;&#43; 实现，是所有其他类加载器的父类加载器，负责加载&lt;Java_HOME&gt;/jre/lib 目录下的JVM 指定类库。 拓展类加载器:加载Java 的拓展类库，加载&lt;Java_HOME&gt;/jre/lib/etx 目录中的类。 应用程序类加载器: 系统类加载器负责加载用户类库中的指定类库。  并且类加载器还有各种机制:
  在Java 中，我们用完全匹配类命名来标识一个类，就是用包名.类名，但是在JVM 中一个类由完全匹配类名和一个类加载器实例的ID来标识一个类，当我们判断两个类是否相等的时候，只要他们由两个不同的类加载器加载的前提下才有意义，否则就算相同的字节码，如果由不同的类加载器实例加载，这两个类也是不相同的。这种特征为我们提供了隔离机制。
  类加载器有一个全盘机制当类加载加载一个类的时候，他的依赖的应用的其他所有类都由这个类加载器加载，除非显示的调用这个其他类加载加载。
  对于类加载器加载对象的时候他只会去加载那些必须的对象，只会加载父类对象，理由也很简单为了实现多态，需要将父类的入口方法连接起来，实现方法表。对于这些父类，调用加载子类的类加载器去加载，并且通过向上委托的方式加载。
  只有真正执行到对应的代码，遇到 new 关键词的时候，才会去加载对应的外部引用的类，达到了按需处理的效果。
  如果当前类加载器，已经加载了对应的类，第二次遇到new时候，Java 会隐式的从方法区中获取对应的类。
    载入器 Tomcat 如果使用的系统的类加载器去加载某个servlet 中所有需要使用的类，那么servlet 就可以访问所有的类，比如 Java 虚拟机中环境变量中CLASSPATH 指明路径下的所有类和库。servlet 应该只允许再入WEB-INF/class 中的目录，以及它的子目录下的类。
并且Tomcat 需要实现自定义类加载器的原因是因为为了提供自动重载的功能。类载入器会开启一个线程不断检查文件的时间戳。如果要实现重载入的功能就必须实现Reload 接口。在Tomcat 7 中已经将Reloader 接口合并入Loader 接口中。
​
WebAppLoader 对于Tomcat 的重载，如果你在 conf/server.xml 的 ｀｀标签设置了 reloadable 为ture 的话,Tomcat 会为你开启一个后台线程，去监控该 Context 中所有classes 文件的修改，并且重新加载。">

<meta itemprop="wordCount" content="1161">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="类加载器 类加载的好处是可以将Java 类动态的加载到 JVM 中并且运行，就可以在程序运行中再加载类。
在Java 体系中，我们可以将系统分为3中类加载器:
 启动类加载器: 加载Java 的核心库，把核心的Java 类加载进JVM。这个加载器使用的原生 C&#43;&#43; 实现，是所有其他类加载器的父类加载器，负责加载&lt;Java_HOME&gt;/jre/lib 目录下的JVM 指定类库。 拓展类加载器:加载Java 的拓展类库，加载&lt;Java_HOME&gt;/jre/lib/etx 目录中的类。 应用程序类加载器: 系统类加载器负责加载用户类库中的指定类库。  并且类加载器还有各种机制:
  在Java 中，我们用完全匹配类命名来标识一个类，就是用包名.类名，但是在JVM 中一个类由完全匹配类名和一个类加载器实例的ID来标识一个类，当我们判断两个类是否相等的时候，只要他们由两个不同的类加载器加载的前提下才有意义，否则就算相同的字节码，如果由不同的类加载器实例加载，这两个类也是不相同的。这种特征为我们提供了隔离机制。
  类加载器有一个全盘机制当类加载加载一个类的时候，他的依赖的应用的其他所有类都由这个类加载器加载，除非显示的调用这个其他类加载加载。
  对于类加载器加载对象的时候他只会去加载那些必须的对象，只会加载父类对象，理由也很简单为了实现多态，需要将父类的入口方法连接起来，实现方法表。对于这些父类，调用加载子类的类加载器去加载，并且通过向上委托的方式加载。
  只有真正执行到对应的代码，遇到 new 关键词的时候，才会去加载对应的外部引用的类，达到了按需处理的效果。
  如果当前类加载器，已经加载了对应的类，第二次遇到new时候，Java 会隐式的从方法区中获取对应的类。
    载入器 Tomcat 如果使用的系统的类加载器去加载某个servlet 中所有需要使用的类，那么servlet 就可以访问所有的类，比如 Java 虚拟机中环境变量中CLASSPATH 指明路径下的所有类和库。servlet 应该只允许再入WEB-INF/class 中的目录，以及它的子目录下的类。
并且Tomcat 需要实现自定义类加载器的原因是因为为了提供自动重载的功能。类载入器会开启一个线程不断检查文件的时间戳。如果要实现重载入的功能就必须实现Reload 接口。在Tomcat 7 中已经将Reloader 接口合并入Loader 接口中。
​
WebAppLoader 对于Tomcat 的重载，如果你在 conf/server.xml 的 ｀｀标签设置了 reloadable 为ture 的话,Tomcat 会为你开启一个后台线程，去监控该 Context 中所有classes 文件的修改，并且重新加载。"/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://xiantang.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      xiantang
    </a>
    <div class="flex-l items-center">
      

      
      













    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        TOMCATS
      </p>
      <h1 class="f1 athelas mb1"></h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="0001-01-01T00:00:00Z">January 1, 0001</time>
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h1 id="类加载器">类加载器</h1>
<p>类加载的好处是可以将Java 类动态的加载到 JVM 中并且运行，就可以在程序运行中再加载类。</p>
<p>在Java 体系中，我们可以将系统分为3中类加载器:</p>
<ul>
<li>启动类加载器: 加载Java 的核心库，把核心的Java 类加载进JVM。这个加载器使用的原生 C++ 实现，是所有其他类加载器的父类加载器，负责加载&lt;Java_HOME&gt;/jre/lib 目录下的JVM 指定类库。</li>
<li>拓展类加载器:加载Java 的拓展类库，加载&lt;Java_HOME&gt;/jre/lib/etx 目录中的类。</li>
<li>应用程序类加载器: 系统类加载器负责加载用户类库中的指定类库。</li>
</ul>
<p><img src="../../images/1569566077883.png" alt="1569566077883"></p>
<p>并且类加载器还有各种机制:</p>
<ul>
<li>
<p>在Java 中，我们用完全匹配类命名来标识一个类，就是用包名.类名，但是在JVM 中一个类由完全匹配类名和一个类加载器实例的ID来标识一个类，当我们判断两个类是否相等的时候，只要他们由两个不同的类加载器加载的前提下才有意义，否则就算相同的字节码，如果由不同的类加载器实例加载，这两个类也是不相同的。这种特征为我们提供了隔离机制。</p>
</li>
<li>
<p>类加载器有一个全盘机制当类加载加载一个类的时候，他的依赖的应用的其他所有类都由这个类加载器加载，除非显示的调用这个其他类加载加载。</p>
<ul>
<li>
<p>对于类加载器加载对象的时候他只会去加载那些必须的对象，只会加载父类对象，理由也很简单为了实现多态，需要将父类的入口方法连接起来，实现方法表。对于这些父类，调用加载子类的类加载器去加载，并且通过向上委托的方式加载。</p>
</li>
<li>
<p>只有真正执行到对应的代码，遇到 new 关键词的时候，才会去加载对应的外部引用的类，达到了按需处理的效果。</p>
</li>
<li>
<p>如果当前类加载器，已经加载了对应的类，第二次遇到new时候，Java 会隐式的从方法区中获取对应的类。</p>
</li>
</ul>
</li>
</ul>
<h1 id="载入器">载入器</h1>
<p>Tomcat 如果使用的系统的类加载器去加载某个servlet 中所有需要使用的类，那么servlet 就可以访问所有的类，比如 Java 虚拟机中环境变量中CLASSPATH 指明路径下的所有类和库。servlet 应该只允许再入WEB-INF/class 中的目录，以及它的子目录下的类。</p>
<p>并且Tomcat 需要实现自定义类加载器的原因是因为为了提供自动重载的功能。类载入器会开启一个线程不断检查文件的时间戳。如果要实现重载入的功能就必须实现Reload 接口。在Tomcat 7 中已经将Reloader 接口合并入Loader 接口中。</p>
<p>​</p>
<h2 id="webapploader">WebAppLoader</h2>
<p>对于Tomcat 的重载，如果你在 conf/server.xml 的 ｀<!-- raw HTML omitted -->｀标签设置了 reloadable 为ture 的话,Tomcat 会为你开启一个后台线程，去监控该 Context 中所有classes 文件的修改，并且重新加载。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">     * Execute a periodic task, such as reloading, etc. This method will be
</span><span style="color:#75715e">     * invoked inside the classloading context of this container. Unexpected
</span><span style="color:#75715e">     * throwables will be caught and logged.
</span><span style="color:#75715e">     */</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">backgroundProcess</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>reloadable <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> modified<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">// 如果发现有文件修改
</span><span style="color:#75715e"></span>      <span style="color:#75715e">// 就将当前线程的类加载类加载器设置为 WebappClassLoader
</span><span style="color:#75715e"></span>      Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setContextClassLoader</span>
        <span style="color:#f92672">(</span>WebappLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>container <span style="color:#66d9ef">instanceof</span> StandardContext<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#f92672">(</span><span style="color:#f92672">(</span>StandardContext<span style="color:#f92672">)</span> container<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">reload</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>container<span style="color:#f92672">.</span><span style="color:#a6e22e">getLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setContextClassLoader</span>
          <span style="color:#f92672">(</span>container<span style="color:#f92672">.</span><span style="color:#a6e22e">getLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
    closeJARs<span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>这个函数将会不断的调用，我们来看看他对应的 WebappLoader.modified() 方法吧！</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#75715e">/**
</span><span style="color:#75715e">     * Has the internal repository associated with this Loader been modified,
</span><span style="color:#75715e">     * such that the loaded classes should be reloaded?
</span><span style="color:#75715e">     */</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">modified</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> classLoader <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">?</span> classLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">modified</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span> <span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

</code></pre></div><p>他会调用WebappLoader 中的属性变量 WebappClassLoader的modified() 方法，而这个方法会检查class 文件和jar 包文件是否被修改，如果被修改的话就立刻返回true ，注意是当遇到第一个被修改的文件，就会返回true。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">     <span style="color:#75715e">/*
</span><span style="color:#75715e">		 * Have one or more classes or resources been modified so that a reload
</span><span style="color:#75715e">     * is appropriate?
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">modified</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>log<span style="color:#f92672">.</span><span style="color:#a6e22e">isDebugEnabled</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
            log<span style="color:#f92672">.</span><span style="color:#a6e22e">debug</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;modified()&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// Checking for modified loaded resources
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> paths<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// A rare race condition can occur in the updates of the two arrays
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// It&#39;s totally ok if the latest class added is not checked (it will
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// be checked the next time
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">int</span> length2 <span style="color:#f92672">=</span> lastModifiedDates<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>length <span style="color:#f92672">&gt;</span> length2<span style="color:#f92672">)</span>
            length <span style="color:#f92672">=</span> length2<span style="color:#f92672">;</span>

        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> length<span style="color:#f92672">;</span> i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">long</span> lastModified <span style="color:#f92672">=</span>
                    <span style="color:#f92672">(</span><span style="color:#f92672">(</span>ResourceAttributes<span style="color:#f92672">)</span> resources<span style="color:#f92672">.</span><span style="color:#a6e22e">getAttributes</span><span style="color:#f92672">(</span>paths<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">getLastModified</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>lastModified <span style="color:#f92672">!</span><span style="color:#f92672">=</span> lastModifiedDates<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span> log<span style="color:#f92672">.</span><span style="color:#a6e22e">isDebugEnabled</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">)</span>
                        log<span style="color:#f92672">.</span><span style="color:#a6e22e">debug</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;  Resource &#39;&#34;</span> <span style="color:#f92672">+</span> paths<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
                                  <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39; was modified; Date is now: &#34;</span>
                                  <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Date</span><span style="color:#f92672">(</span>lastModified<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; Was: &#34;</span>
                                  <span style="color:#f92672">+</span> <span style="color:#66d9ef">new</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">util</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Date</span><span style="color:#f92672">(</span>lastModifiedDates<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NamingException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                log<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;    Resource &#39;&#34;</span> <span style="color:#f92672">+</span> paths<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39; is missing&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

        length <span style="color:#f92672">=</span> jarNames<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// Check if JARs have been added or removed
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>getJarPath<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                NamingEnumeration<span style="color:#f92672">&lt;</span>Binding<span style="color:#f92672">&gt;</span> enumeration <span style="color:#f92672">=</span>
                    resources<span style="color:#f92672">.</span><span style="color:#a6e22e">listBindings</span><span style="color:#f92672">(</span>getJarPath<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
                <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>enumeration<span style="color:#f92672">.</span><span style="color:#a6e22e">hasMoreElements</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">(</span>i <span style="color:#f92672">&lt;</span> length<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    NameClassPair ncPair <span style="color:#f92672">=</span> enumeration<span style="color:#f92672">.</span><span style="color:#a6e22e">nextElement</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    String name <span style="color:#f92672">=</span> ncPair<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    <span style="color:#75715e">// Ignore non JARs present in the lib folder
</span><span style="color:#75715e"></span>                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">!</span>name<span style="color:#f92672">.</span><span style="color:#a6e22e">endsWith</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;.jar&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                        <span style="color:#66d9ef">continue</span><span style="color:#f92672">;</span>
                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">!</span>name<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>jarNames<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        <span style="color:#75715e">// Missing JAR
</span><span style="color:#75715e"></span>                        log<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;    Additional JARs have been added : &#39;&#34;</span>
                                 <span style="color:#f92672">+</span> name <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    <span style="color:#f92672">}</span>
                    i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>enumeration<span style="color:#f92672">.</span><span style="color:#a6e22e">hasMoreElements</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">while</span> <span style="color:#f92672">(</span>enumeration<span style="color:#f92672">.</span><span style="color:#a6e22e">hasMoreElements</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                        NameClassPair ncPair <span style="color:#f92672">=</span> enumeration<span style="color:#f92672">.</span><span style="color:#a6e22e">nextElement</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        String name <span style="color:#f92672">=</span> ncPair<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#75715e">// Additional non-JAR files are allowed
</span><span style="color:#75715e"></span>                        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>name<span style="color:#f92672">.</span><span style="color:#a6e22e">endsWith</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;.jar&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                            <span style="color:#75715e">// There was more JARs
</span><span style="color:#75715e"></span>                            log<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;    Additional JARs have been added&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                            <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                        <span style="color:#f92672">}</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>i <span style="color:#f92672">&lt;</span> jarNames<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#75715e">// There was less JARs
</span><span style="color:#75715e"></span>                    log<span style="color:#f92672">.</span><span style="color:#a6e22e">info</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;    Additional JARs have been added&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                    <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>NamingException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>log<span style="color:#f92672">.</span><span style="color:#a6e22e">isDebugEnabled</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
                    log<span style="color:#f92672">.</span><span style="color:#a6e22e">debug</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;    Failed tracking modifications of &#39;&#34;</span>
                        <span style="color:#f92672">+</span> getJarPath<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ClassCastException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                log<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;    Failed tracking modifications of &#39;&#34;</span>
                          <span style="color:#f92672">+</span> getJarPath<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39; : &#34;</span> <span style="color:#f92672">+</span> e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

        <span style="color:#f92672">}</span>

        <span style="color:#75715e">// No classes have been modified
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#f92672">}</span>
</code></pre></div><p>下面我们会到WebappLoader 的	backgroundProcess() 方法，来看看发现修改之后到底会做一些什么事情呢？</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">backgroundProcess</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>reloadable <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> modified<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">// 如果发现有文件修改
</span><span style="color:#75715e"></span>                <span style="color:#75715e">// 就将当前线程的类加载类加载器设置为 WebappClassLoader
</span><span style="color:#75715e"></span>                Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setContextClassLoader</span>
                    <span style="color:#f92672">(</span>WebappLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>container <span style="color:#66d9ef">instanceof</span> StandardContext<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#f92672">(</span><span style="color:#f92672">(</span>StandardContext<span style="color:#f92672">)</span> container<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">reload</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>container<span style="color:#f92672">.</span><span style="color:#a6e22e">getLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    Thread<span style="color:#f92672">.</span><span style="color:#a6e22e">currentThread</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setContextClassLoader</span>
                        <span style="color:#f92672">(</span>container<span style="color:#f92672">.</span><span style="color:#a6e22e">getLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getClassLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
            closeJARs<span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>他会调用Context 的reload() 方法，我们可以简单的看一下他的作用:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reload</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

        <span style="color:#75715e">// 省略
</span><span style="color:#75715e"></span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            stop<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>LifecycleException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            log<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>
                sm<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;standardContext.stoppingContext&#34;</span><span style="color:#f92672">,</span> getName<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> e<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            start<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>LifecycleException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            log<span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>
                sm<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;standardContext.startingContext&#34;</span><span style="color:#f92672">,</span> getName<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> e<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>

        setPaused<span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

        <span style="color:#75715e">// 省略
</span><span style="color:#75715e"></span>
    <span style="color:#f92672">}</span>

</code></pre></div><p>他主要会调用 stop() 和 start() 方法。  但是你会提出一个疑问，怎么就调用了生命周期的 stop() 和 start() 就能够完成类的热加载呢？ 这完全不科学</p>
<p>stop 和 start 都会调用 StandardContext 的生命周期函数start/stopInternal 我们可以看看这里有有没有什么思路</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">stopInternal</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> LifecycleException <span style="color:#f92672">{</span>


 		<span style="color:#75715e">// 略
</span><span style="color:#75715e"></span>				<span style="color:#75715e">// 关闭子容器
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>

            <span style="color:#75715e">// Stop our child containers, if any
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">final</span> Container<span style="color:#f92672">[</span><span style="color:#f92672">]</span> children <span style="color:#f92672">=</span> findChildren<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            
            ClassLoader old <span style="color:#f92672">=</span> bindThread<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                <span style="color:#75715e">// Stop ContainerBackgroundProcessor thread
</span><span style="color:#75715e"></span>                threadStop<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

                <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> children<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    children<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            
                <span style="color:#75715e">// Stop our filters
</span><span style="color:#75715e"></span>                filterStop<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            
                <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>manager <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> manager <span style="color:#66d9ef">instanceof</span> Lifecycle <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span>
                        <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> manager<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getState</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">isAvailable</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> manager<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            
                <span style="color:#75715e">// Stop our application listeners
</span><span style="color:#75715e"></span>                listenerStop<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span><span style="color:#f92672">{</span>
                unbindThread<span style="color:#f92672">(</span>old<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>


						<span style="color:#75715e">// 关闭ClassLoader
</span><span style="color:#75715e"></span>            Realm realm <span style="color:#f92672">=</span> getRealmInternal<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>realm <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">(</span>realm <span style="color:#66d9ef">instanceof</span> Lifecycle<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> realm<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>cluster <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">(</span>cluster <span style="color:#66d9ef">instanceof</span> Lifecycle<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> cluster<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>loader <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">(</span>loader <span style="color:#66d9ef">instanceof</span> Lifecycle<span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> loader<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

        <span style="color:#f92672">}</span> <span style="color:#66d9ef">finally</span> <span style="color:#f92672">{</span>

            <span style="color:#75715e">// Unbinding thread
</span><span style="color:#75715e"></span>            unbindThread<span style="color:#f92672">(</span>oldCCL<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

        <span style="color:#f92672">}</span>
		<span style="color:#75715e">// 略
</span><span style="color:#75715e"></span>

    <span style="color:#f92672">}</span>
</code></pre></div><p>其实代码很长，我们只需要关注两个点，一个是关闭下面的子容器Wrapper 一个是关闭对应的ClassLoader 这里的ClassLoader 也是WebappLoader 他也有自己的生命周期函数，当他调用的时候，他会将内部的WebappClassLoader 实例执行 stop 生命周期函数(主要是将一些属性置为null 方便gc), 然后将这个实例置为null 方法垃圾收集器回收。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">WebappClassLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e">* Stop the class loader.
</span><span style="color:#75715e">*
</span><span style="color:#75715e">* @exception LifecycleException if a lifecycle error occurs
</span><span style="color:#75715e">*/</span>
<span style="color:#a6e22e">@Override</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> LifecycleException <span style="color:#f92672">{</span>
		notFoundResources<span style="color:#f92672">.</span><span style="color:#a6e22e">clear</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    resourceEntries<span style="color:#f92672">.</span><span style="color:#a6e22e">clear</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    resources <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    repositories <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    repositoryURLs <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    files <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    jarFiles <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    jarRealFiles <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    jarPath <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    jarNames <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    lastModifiedDates <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    paths <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    hasExternalRepositories <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
    parent <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">WebappLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">stopInternal</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
<span style="color:#75715e">// Throw away our current class loader
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>classLoader <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> classLoader<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    DirContextURLStreamHandler<span style="color:#f92672">.</span><span style="color:#a6e22e">unbind</span><span style="color:#f92672">(</span>classLoader<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>


classLoader <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
</code></pre></div><p>我们发现了这个stop()函数会将Context 的所有成员变量都清除，可以想象为一个卸载的过程，我们再来看看这个start() 对应的startInternal 是怎么样的吧!</p>
<p>首先他会将webappLoader 设置为属性，但是这是内部的webappClassLoader 是空的</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>getLoader<span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            WebappLoader webappLoader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> WebappLoader<span style="color:#f92672">(</span>getParentClassLoader<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            webappLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">setDelegate</span><span style="color:#f92672">(</span>getDelegate<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            setLoader<span style="color:#f92672">(</span>webappLoader<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span> 
</code></pre></div><p>随后会调用 webappLoader 对应的生命周期函数:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> <span style="color:#75715e">// Start our subordinate components, if any
</span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span>loader <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">(</span>loader <span style="color:#66d9ef">instanceof</span> Lifecycle<span style="color:#f92672">)</span><span style="color:#f92672">)</span>
  <span style="color:#f92672">(</span><span style="color:#f92672">(</span>Lifecycle<span style="color:#f92672">)</span> loader<span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

</code></pre></div><p>需要关注的是这个生命周期函数的内部调用了一个重要方法createClassLoader() ，就是这个方法对内部的webappClassLoader 进行赋值。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">     * Create associated classLoader.
</span><span style="color:#75715e">     */</span>
<span style="color:#66d9ef">private</span> String loaderClass <span style="color:#f92672">=</span>
        <span style="color:#e6db74">&#34;org.apache.catalina.loader.WebappClassLoader&#34;</span><span style="color:#f92672">;</span>
<span style="color:#66d9ef">private</span> WebappClassLoader <span style="color:#a6e22e">createClassLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
  <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>

  Class<span style="color:#f92672">&lt;</span><span style="color:#f92672">?</span><span style="color:#f92672">&gt;</span> clazz <span style="color:#f92672">=</span> Class<span style="color:#f92672">.</span><span style="color:#a6e22e">forName</span><span style="color:#f92672">(</span>loaderClass<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  WebappClassLoader classLoader <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>

  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>parentClassLoader <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    parentClassLoader <span style="color:#f92672">=</span> container<span style="color:#f92672">.</span><span style="color:#a6e22e">getParentClassLoader</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>
  Class<span style="color:#f92672">&lt;</span><span style="color:#f92672">?</span><span style="color:#f92672">&gt;</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> argTypes <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> ClassLoader<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">}</span><span style="color:#f92672">;</span>
  Object<span style="color:#f92672">[</span><span style="color:#f92672">]</span> args <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> parentClassLoader <span style="color:#f92672">}</span><span style="color:#f92672">;</span>
  Constructor<span style="color:#f92672">&lt;</span><span style="color:#f92672">?</span><span style="color:#f92672">&gt;</span> constr <span style="color:#f92672">=</span> clazz<span style="color:#f92672">.</span><span style="color:#a6e22e">getConstructor</span><span style="color:#f92672">(</span>argTypes<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  classLoader <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>WebappClassLoader<span style="color:#f92672">)</span> constr<span style="color:#f92672">.</span><span style="color:#a6e22e">newInstance</span><span style="color:#f92672">(</span>args<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

  <span style="color:#66d9ef">return</span> classLoader<span style="color:#f92672">;</span>

<span style="color:#f92672">}</span>
</code></pre></div><p>他才用反射的方式创建了classLoader 并将其返回。</p>
<p>当classLoader 相关参数配置完成后，StandardContext 会调用loadOnStartup() 方法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loadOnStartup</span><span style="color:#f92672">(</span>Container children<span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

  <span style="color:#75715e">// Collect &#34;load on startup&#34; servlets that need to be initialized
</span><span style="color:#75715e"></span>  TreeMap<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> ArrayList<span style="color:#f92672">&lt;</span>Wrapper<span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> map <span style="color:#f92672">=</span>
    <span style="color:#66d9ef">new</span> TreeMap<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">,</span> ArrayList<span style="color:#f92672">&lt;</span>Wrapper<span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> children<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    Wrapper wrapper <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Wrapper<span style="color:#f92672">)</span> children<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">int</span> loadOnStartup <span style="color:#f92672">=</span> wrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">getLoadOnStartup</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>loadOnStartup <span style="color:#f92672">&lt;</span> 0<span style="color:#f92672">)</span>
      <span style="color:#66d9ef">continue</span><span style="color:#f92672">;</span>
    Integer key <span style="color:#f92672">=</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>loadOnStartup<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    ArrayList<span style="color:#f92672">&lt;</span>Wrapper<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> map<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>key<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>list <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Wrapper<span style="color:#f92672">&gt;</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      map<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span>key<span style="color:#f92672">,</span> list<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>wrapper<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">// Load the collected &#34;load on startup&#34; servlets
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>ArrayList<span style="color:#f92672">&lt;</span>Wrapper<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">:</span> map<span style="color:#f92672">.</span><span style="color:#a6e22e">values</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>Wrapper wrapper <span style="color:#f92672">:</span> list<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
        wrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">load</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>ServletException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        getLogger<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">error</span><span style="color:#f92672">(</span>sm<span style="color:#f92672">.</span><span style="color:#a6e22e">getString</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;standardWrapper.loadException&#34;</span><span style="color:#f92672">,</span>
                                       getName<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> StandardWrapper<span style="color:#f92672">.</span><span style="color:#a6e22e">getRootCause</span><span style="color:#f92672">(</span>e<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">// NOTE: load errors (including a servlet that throws
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// UnavailableException from tht init() method) are NOT
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// fatal to application startup
</span><span style="color:#75715e"></span>      <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span>
</code></pre></div><p>这个函数比较简单，分为两步，一个是收集 load on start up 的类。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;servlet</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;servlet-name</span><span style="color:#f92672">&gt;</span>default<span style="color:#f92672">&lt;/servlet-name&gt;</span>
  <span style="color:#f92672">&lt;servlet-class</span><span style="color:#f92672">&gt;</span>org.apache.catalina.servlets.DefaultServlet<span style="color:#f92672">&lt;/servlet-class&gt;</span>
  <span style="color:#f92672">&lt;init-param</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;param-name</span><span style="color:#f92672">&gt;</span>debug<span style="color:#f92672">&lt;/param-name&gt;</span>
    <span style="color:#f92672">&lt;param-value</span><span style="color:#f92672">&gt;</span>0<span style="color:#f92672">&lt;/param-value&gt;</span>
  <span style="color:#f92672">&lt;/init-param&gt;</span>
  <span style="color:#f92672">&lt;init-param</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;param-name</span><span style="color:#f92672">&gt;</span>listings<span style="color:#f92672">&lt;/param-name&gt;</span>
    <span style="color:#f92672">&lt;param-value</span><span style="color:#f92672">&gt;</span>false<span style="color:#f92672">&lt;/param-value&gt;</span>
  <span style="color:#f92672">&lt;/init-param&gt;</span>
  <span style="color:#f92672">&lt;load-on-startup</span><span style="color:#f92672">&gt;</span>1<span style="color:#f92672">&lt;/load-on-startup&gt;</span>
<span style="color:#f92672">&lt;/servlet&gt;</span>

<span style="color:#f92672">&lt;servlet</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;servlet-name</span><span style="color:#f92672">&gt;</span>jsp<span style="color:#f92672">&lt;/servlet-name&gt;</span>
  <span style="color:#f92672">&lt;servlet-class</span><span style="color:#f92672">&gt;</span>org.apache.jasper.servlet.JspServlet<span style="color:#f92672">&lt;/servlet-class&gt;</span>
  <span style="color:#f92672">&lt;init-param</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;param-name</span><span style="color:#f92672">&gt;</span>fork<span style="color:#f92672">&lt;/param-name&gt;</span>
    <span style="color:#f92672">&lt;param-value</span><span style="color:#f92672">&gt;</span>false<span style="color:#f92672">&lt;/param-value&gt;</span>
  <span style="color:#f92672">&lt;/init-param&gt;</span>
  <span style="color:#f92672">&lt;init-param</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;param-name</span><span style="color:#f92672">&gt;</span>xpoweredBy<span style="color:#f92672">&lt;/param-name&gt;</span>
    <span style="color:#f92672">&lt;param-value</span><span style="color:#f92672">&gt;</span>false<span style="color:#f92672">&lt;/param-value&gt;</span>
  <span style="color:#f92672">&lt;/init-param&gt;</span>
  <span style="color:#f92672">&lt;load-on-startup</span><span style="color:#f92672">&gt;</span>3<span style="color:#f92672">&lt;/load-on-startup&gt;</span>
<span style="color:#f92672">&lt;/servlet&gt;</span>
</code></pre></div><p>随后调用wrapper.load();将他们加载。</p>
<h2 id="总结">总结</h2>
<p>可以看出Tomcat 对于类重载不是真正意义上的重载，他只是重新卸载一遍Context 将那些在Context中所有装载好的类全部卸载，然后将Context 重新装载，并且只装载那些写在 load on start up 上的 servlet ,对于那些已经修改好的类，之后只需要通过反射重新加载就成了。</p>
<p>思考：现在我们的业务代码是写在Servlet 上的，这时候我修改了一个类是Servlet 需要引用的，这时候我们热加载并调试的流程是怎么样的?</p>
<p>ans: 首先Tomcat 的线程监听到 WEB-INF 下面的 classes 有文件被修改,随后找出这个文件，并且卸载这个文件对应的Context( 就是你的应用程序) 随后加载那些 load on start up  的servlet，并没有加载你的业务 servlet, 随后你打开浏览器访问你的对应URL Tomcat 对你的servlet 进行加载，并且执行这个service() 方法，遇到了 new 了你修改的类，这时候就会用webappClassLoader 加载并运行新类的代码。</p>
<p>// TODO Servlet InstanceManage</p>
<ul class="pa0">
  
</ul>
<div class="mt6">
      
      
      </div>
    </section>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://xiantang.github.io/" >
    &copy;  xiantang 2020 
  </a>
    <div>












</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
